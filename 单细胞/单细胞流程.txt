######10X

#####参考这个网站给添加自己的基因到注释上
https://kb.10xgenomics.com/hc/en-us/articles/11500332711X2-How-can-we-add-genes-to-a-reference-package-for-Cell-Ranger

######cellranger ref 存储路径
/home/mnt1/wanghao/project/LINE1_evolution/OR_receptor/LINE1_OR_Data/singlecell/GSE173947/cellranger/cellRanger_ref

#####将I-Scel 添加进基因组
####在/home/mnt1/wanghao/project/LINE1_evolution/OR_receptor/LINE1_OR_Data/singlecell/GSE173947/cellranger/cellRanger_ref/mm10_IScel 文件夹
cat >> genome.fa <<EOF
>I-SceI
ATGGGATCATCATCAGACGACGAAGCTACGGCCGATGCGCAGCATGCAGCAccaccaaaaaaaaaacgaaaagtaGAAGACCCACGATTTATGtacccatacgatgttcctgactatgcgGGTATGAAAAACATCAAAAAAAACCAGGTAATGAACCTGGGTCCGAACTCTAAACTGCTGAAAGAATACAAATCCCAGCTGATCGAACTGAACATCGAACAGTTCGAAGCAGGTATCGGTCTGATCCTGGGTGATGCTTACATCCGTTCTCGTGATGAAGGTAAAACCTACTGTATGCAGTTCGAGTGGAAAAACAAAGCATACATGGACCACGTATGTCTGCTGTACGATCAGTGGGTACTGTCCCCGCCGCACAAAAAAGAACGTGTTAACCACCTGGGTAACCTGGTAATCACCTGGGGCGCCCAGACTTTCAAACACCAAGCTTTCAACAAACTGGCTAACCTGTTCATCGTTAACAACAAAAAAACCATCCCGAACAACCTGGTTGAAAACTACCTGACCCCGATGTCTCTGGCATACTGGTTCATGGATGATGGTGGTAAATGGGATTACAACAAAAACTCTACCAACAAATCGATCGTACTGAACACCCAGTCTTTCACTTTCGAAGAAGTAGAATACCTGGTTAAGGGTCTGCGTAACAAATTCCAACTGAACTGTTACGTAAAAATCAACAAAAACAAACCGATCATCTACATCGATTCTATGTCTTACCTGATCTTCTACAACCTGATCAAACCGTACCTGATCCCGCAGATGATGTACAAACTGCCGAACACTATCTCCTCCGAAACTTTCCTGAAATAAtaagtcgactctag
EOF
####将记录添加进gtf文件
echo -e "I-SceI\tunknown\texon\t1\t845\t.\t+\t.\tgene_id \"I-SceI\"; transcript_id \"I-SceI\"; exon_number \"1\"; gene_name \"I-SceI\";" >> genes.gtf

##sed -i '/^I-SceI/d' genes.gtf (去除I-Scel行)
#####构建新的参考文件
cellranger mkref \
  --genome=mm10_IScel \
  --fasta=genome.fa \
  --genes=genes.gtf

